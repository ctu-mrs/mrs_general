<launch>
  <arg name="uav_name" default="$(optenv UAV_NAME uav)"/>
  <arg name="timeout" default="10"/>

  <group ns="$(arg uav_name)">
    
    <!-- Service server -->
    <node name="udp_service_server" pkg="nimbro_service_transport" type="udp_server" output="screen">
      <param name="port" value="6556" />
    </node>

    <!-- Service client -->
    <node name="udp_service_client" pkg="nimbro_service_transport" type="udp_client" output="screen">
		  <param name="port" value="6556" />
      <param name="limit" type="int" value="$(arg timeout)" /> <!-- Service response timeout [seconds]. --> 
		  <!-- Load a config YAML file -->
      <rosparam command="load" file="$(find mrs_general)/config/uav_names.yaml" />
      <rosparam command="load" file="$(find mrs_general)/config/communication_config.yaml" />
	  </node>

    
    <!-- Topic receiver -->
    <node name="udp_topic_receiver" pkg="nimbro_topic_transport" type="udp_receiver" output="screen">
      <!-- The port to receive packets on -->
      <param name="port" value="17001" />
    </node>

    <!-- Topic sender -->
    <node name="udp_topic_sender" pkg="nimbro_topic_transport" type="udp_sender" output="screen">

      <!-- The destination host name or IP address -->
      <param name="destination_port" value="17001" />

      <!-- Load a config YAML file -->
      <rosparam command="load" file="$(find mrs_general)/config/uav_names.yaml" />
      <rosparam command="load" file="$(find mrs_general)/config/communication_config.yaml" />
    </node>
  </group>

</launch>
